<% include partials/header %>

<div class="container">
  <div class="row">
    <div class="col-md-3">
      <p class="lead">YelpCamp</p>
      <div class="list-group">
        <li class="list-group-item">Info 1</li>
        <li class="list-group-item">Info 2</li>
        <li class="list-group-item">Info 3</li>
      </div>
    </div>
    <div class="col-md-9">
      <img class="img-thumbnail" src="<%= campground.image %>">
      <br><br>
      <div class="caption-full  container-camp">
        <h5 class="float-right underline">$50.00/night</h5>
        <h4><%=  campground.name %></h4>
        <div class="row">
          <div class="col-md-12">
            <p>Posted by
              <% if (user && campground.author.username === user.username) { %>
                <strong><i>you</i></strong>
              <% } else { %>
                <strong><i><%= campground.author.username %></i></strong>
              <% } %>
              <span class="float-right" title="<%= moment(campground.created).format() %>"><%= moment(campground.created).format('dddd, MMM DD YYYY') %></span>
            </p>
          </div>
        </div>
      </div>
      <p><%=  campground.description %></p>
      <% if (user && campground.author.username === user.username) { %>
        <div class="modify row">
            <a class="btn btn-outline-warning btn-sm" href="/campground/<%= campground._id%>/edit">Edit Campground</a>
            <form action="/campground/<%= campground._id %>?_method=DELETE" method="POST">
              <button class="btn btn-outline-danger btn-sm" onclick="return confirm('Are you sure?')">Delete Campground</button>
            </form>
          </div>
      <% } %>

      <div class="well">
        <h5>Comments</h5>
        <%  campground.comments.forEach(function(comment) { %>
          <div class="row">
            <div class="col-md-12">
              By 
              <% if (user && comment.author.username === user.username) { %>
                <strong><i>you</i></strong>
              <% } else { %>
                <strong><i><%= comment.author.username %></i></strong>
              <% } %>
              <span class="float-right" title="<%= moment(comment.created).format() %>"><%= moment(moment(comment.created).format('YYYYMMDDkkmmss'), 'YYYYMMDDkkmmss').fromNow() %></span>
              <br>
              <p>
                <%= comment.text %>
              </p>
            </div>
          </div>
          <% if (user && comment.author.username === user.username) { %>
            <div class="modify row">
              <button class="btn btn-warning btn-sm">Edit Comment</button>
              <form action="/campground/<%= campground._id %>/comments/<%= comment._id %>?_method=DELETE" method="POST">
                <button class="btn btn-danger btn-sm" onclick="return confirm('Are you sure?')">Delete Comment</button>
              </form>
            </div>
          <% } %>
        <% }) %>
        <form action="/campground/<%= campground.id%>" method="POST">
          <div class="form-group">
          <input class="form-control" type="text" name="comment[text]" placeholder="new comment goes here...">
          </div>
          <div class="form-group">
          <button class="btn btn-info">Submit Comment</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<% include partials/footer %>